<div class="container takasa">
  <div class="row row-new">

    <h2>商品新規登録</h2><br>

    <!-- 画像選択欄 -->
    <div class="col-xs-4">
      <%= form_for(@item, url:admin_items_path) do |f| %>

      <div class="item-image">
        <%= attachment_image_tag @item, :image, class: "img-square", fallback: "no_image.jpg", size:"300x300" %>
      </div><br>

      <%= f.attachment_field :image, placeholder: "商品画像" %>

    </div>

    <!-- 商品登録フォーム -->
    <div class="col-xs-8">

      <form>
        <div class="new-field">
          <h4><%= f.label :商品名 ,class: "col-xs-3" %>
          <%= f.text_field :item_name, autofocus: true, autocomplete: "item_name" ,class: "col-xs-8"%></h4>
        </div>
        <div class="new-field">
          <h4><%= f.label :商品説明 ,class: "col-xs-3" %>
          <%= f.text_area :explanation, autofocus: true, autocomplete: "explanation" ,class: "col-xs-8"%></h4>
        </div>
        <div class="new-field">
          <h4><%= f.label :ジャンル ,class: "col-xs-3 fix" %>
          <%= f.collection_select :genre_id, Genre.all, :id, :name %></h4>
          <!-- f.collection_select(プロパティ名, オブジェクトの配列, value属性の項目, 表示テキストの項目) -->
          <!-- Genre.allでジャンルのテーブル内情報を持ってきてる -->

        </div>
        <div class="new-field">
          <h4><%= f.label :税抜価格 ,class: "col-xs-3 block"  %>
          <%= f.text_field :unit_price_without_tax, autofocus: true, autocomplete: "unit_price_without_tax" ,class: "col-xs-8"%></h4>
        </div>
        <div class="new-field">
          <h4><%= f.label :販売ステータス  ,class: "col-xs-3 fix" %>
          <%= f.select :sale_status, ["販売中", "販売停止"] ,class: "btn btn-primary"%></h4>
        </div>
        <div class="text-right"><%= f.submit "商品登録" ,class: "btn btn-primary"%></div>
        <% end %>
      </form>

    </div>
  </div>
</div>

<script>
$(function(){
    // inputのidから情報の取得
    $('#item_image').on('change', function (e) {
// ここから既存の画像のurlの取得
    var reader = new FileReader();
    reader.onload = function (e) {
        $(".item.image").attr('src', e.target.result);
    }
// ここまで
    reader.readAsDataURL(e.target.files[0]); //取得したurlにアップロード画像のurlを挿入
});
});

</script>